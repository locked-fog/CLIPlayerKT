# CLIPlayer (Kotlin Edition)

**CLIPlayer** æ˜¯ä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„â€œåŠ¨æ„Ÿæ–‡å­—â€æ’­æ”¾å™¨ï¼ˆKinetic Typography Playerï¼‰ã€‚æœ¬é¡¹ç›®æ˜¯åŸ C++ ç‰ˆæœ¬çš„å®Œå…¨é‡æ„ç‰ˆï¼Œé‡‡ç”¨ Kotlin ç¼–å†™ï¼Œæ—¨åœ¨é€šè¿‡ç®€æ˜“çš„è„šæœ¬è¯­è¨€ï¼Œåœ¨ç»ˆç«¯ä¸­å®ç°è§†å¬åŒæ­¥çš„æ–‡å­— PV æ¼”å‡ºã€‚

å¾—ç›Šäº JVM å’Œç°ä»£ TUI åº“ï¼Œå®ƒèƒ½å¤ŸçœŸæ­£çš„åœ¨ Windowsã€Linux å’Œ macOS ä¸Šæä¾›ä¸€è‡´çš„ã€é«˜ç²¾åº¦çš„æ¸²æŸ“ä½“éªŒï¼Œæ— éœ€å¤æ‚çš„é…ç½®ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§ (Features)

### ğŸš€ æŠ€æœ¯æ¶æ„
* **çœŸæ­£è·¨å¹³å°**ï¼šåŸºäº JVM è¿è¡Œï¼Œé€šè¿‡ ShadowJar åˆ†å‘å•æ–‡ä»¶ï¼Œå¼€ç®±å³ç”¨ã€‚
* **é›¶åŸç”Ÿä¾èµ–**ï¼šå†…ç½®çº¯ Java MP3 è§£ç å™¨ (JLayer)ï¼Œæ— éœ€å®‰è£… FFmpeg æˆ–ç³»ç»ŸåŠ¨æ€åº“ã€‚
* **ç°ä»£ç»ˆç«¯æ¸²æŸ“**ï¼šåˆ©ç”¨ Mordant åº“ï¼Œè‡ªåŠ¨é€‚é… Windows CMD/PowerShell çš„ ANSI é¢œè‰²æ”¯æŒï¼Œå‘Šåˆ«ä¹±ç ã€‚
* **é«˜ç²¾åº¦åŒæ­¥**ï¼šåŸºäºç³»ç»Ÿé«˜ç²¾åº¦æ—¶é’Ÿçš„äº‹ä»¶å¾ªç¯ï¼Œæ”¯æŒæ¯«ç§’çº§çš„æ—¶é—´è½´æ§åˆ¶ã€‚

### ğŸ“ Script å¼•æ“
* **åŠ¨æ€æ—¶é—´è½´**ï¼šæ”¯æŒ **BPM (èŠ‚æ‹)** è®¡é‡ï¼Œæ”¯æŒç»å¯¹æ—¶é—´ä¸ç›¸å¯¹æ—¶é—´æ··åˆä½¿ç”¨ã€‚
* **å‡½æ•°ä¸å®**ï¼šæ”¯æŒå®šä¹‰å¸¦å‚å‡½æ•°å’Œåˆ«åï¼Œæå¤§åœ°å‡å°‘äº†é‡å¤ä»£ç ã€‚
* **å¤šè¡Œæ¥ç»­**ï¼šè§£å†³äº†é•¿æ–‡æœ¬çš„æ—¶é—´è½´å®šä¹‰éš¾é¢˜ã€‚
* **ä¸°å¯Œè¡¨ç°åŠ›**ï¼šæ”¯æŒ 1600 ä¸‡è‰² (TrueColor) æ–‡å­—ä¸èƒŒæ™¯ã€å…‰æ ‡ä»»æ„ç§»åŠ¨ã€æ ·å¼å åŠ ã€‚
* **ä¸¥è°¨çš„è¯­æ³•**ï¼šæ”¯æŒæ ‡å‡†è½¬ä¹‰å­—ç¬¦ï¼Œæ‹¥æœ‰å®Œå–„çš„é”™è¯¯æ£€æŸ¥æœºåˆ¶ã€‚

---

## ğŸ› ï¸ æ„å»ºä¸è¿è¡Œ (Build & Run)

### ç¯å¢ƒè¦æ±‚
* JDK 21+
* Kotlin 2.2.20

### ç¼–è¯‘
```bash
# ç”Ÿæˆå¯æ‰§è¡Œ JAR åŒ… (ä½äº build/libs/)
./gradlew shadowJar

```

### è¿è¡Œ

```bash
# æ’­æ”¾è„šæœ¬
java -jar build/libs/CLIPlayer-0.0.1-SNAPSHOT-all.jar script.clip

# æ’­æ”¾è„šæœ¬å¹¶æŒ‡å®šèƒŒæ™¯éŸ³ä¹
java -jar build/libs/CLIPlayer-0.0.1-SNAPSHOT-all.jar script.clip -m music.mp3

```

---

## ğŸ“– è„šæœ¬ç¼–å†™æŒ‡å— (Script Guide)

CLIPlayer ä½¿ç”¨ `.clip` è„šæœ¬æ–‡ä»¶æ¥å®šä¹‰æ¼”å‡ºå†…å®¹ã€‚

### 1. åŸºç¡€è§„åˆ™

* **æŒ‡ä»¤**ï¼šæ‰€æœ‰æŒ‡ä»¤åŒ…è£¹åœ¨ `[]` ä¸­ï¼Œå¦‚ `[clear]`, `[bpm 120]`ã€‚
* **æ–‡æœ¬**ï¼šæœªåŒ…è£¹çš„å†…å®¹ç›´æ¥è¾“å‡ºã€‚
* **æ³¨é‡Š**ï¼šä»¥ `//` å¼€å¤´çš„è¡Œå°†è¢«å¿½ç•¥ã€‚
* **è½¬ä¹‰**ï¼š
* `\[`, `\]` : è½¬ä¹‰æ–¹æ‹¬å·ã€‚
* `\\` : è½¬ä¹‰åæ–œæ ã€‚
* `\n` : æ¢è¡Œç¬¦ã€‚



### 2. æ—¶é—´è½´ (Timeline)

è„šæœ¬çš„**æ¯ä¸€è¡Œ**ï¼ˆé™¤äº†æ¥ç»­è¡Œã€BPMè®¾ç½®ã€å…ƒæŒ‡ä»¤ï¼‰éƒ½**å¿…é¡»**ä»¥æ—¶é—´æˆ³å¼€å¤´ã€‚

#### ç»å¯¹æ—¶é—´ (Absolute)

* `[mm:ss.xxx]` : æ ‡å‡†æ—¶é—´æ ¼å¼ (ä¾‹: `[00:01.500]`)
* `[xxb]` : ç¬¬ xx æ‹ (ä¾‹: `[4b]`, `[4.5b]`)
* `[xxb+xxx]` : æ‹æ•° + æ¯«ç§’åç§» (ä¾‹: `[4b+500]`)
* `[xxb+nbn]` : æ‹æ•° + åˆ†æ•°æ‹åç§» (ä¾‹: `[4b+1b3]` è¡¨ç¤º 4æ‹ + 1/3æ‹)

#### ç›¸å¯¹æ—¶é—´ (Relative)

åŸºäºä¸Šä¸€è¡Œçš„æ—¶é—´ç‚¹è¿›è¡Œæ¨ç§»ã€‚

* `[+xxx]` : å¢åŠ æ¯«ç§’ (ä¾‹: `[+500]`)
* `[+xxb]` : å¢åŠ æ‹æ•° (ä¾‹: `[+1b]`, `[+0.5b]`)
* `[+nbn]` : å¢åŠ åˆ†æ•°æ‹ (ä¾‹: `[+1b2]` å¢åŠ åŠæ‹)

#### å¤šè¡Œæ¥ç»­ (Continuation)

åœ¨è¡Œæœ«ä½¿ç”¨ `[>]` æ ‡è®°ï¼Œè¡¨ç¤ºä¸‹ä¸€è¡Œå±äºå½“å‰æ—¶é—´å¸§ï¼Œ**ä¸éœ€è¦**å†æ¬¡å®šä¹‰æ—¶é—´æˆ³ã€‚

```text
[1b]è¿™æ˜¯ç¬¬ä¸€è¡Œå†…å®¹[>]
è¿™æ˜¯ç´§æ¥ç€è¾“å‡ºçš„ç¬¬äºŒè¡Œå†…å®¹

```

### 3. æŒ‡ä»¤å‚è€ƒ (Command Reference)

#### å…¨å±€æ§åˆ¶

* `[bpm <value>]` : è®¾ç½®å½“å‰çš„ BPM (Beats Per Minute)ã€‚å¯éšæ—¶æ›´æ”¹ã€‚

#### å±å¹•ä¸æ’ç‰ˆ

* `[newline]` : æ¢è¡Œã€‚
* `[space]` / `[space <n>]` : è¾“å‡º 1 ä¸ªæˆ– n ä¸ªç©ºæ ¼ã€‚
* `[clear]` : æ¸…å±å¹¶å°†å…‰æ ‡å¤ä½åˆ° (1,1)ã€‚
* `[clearn]` : æ¸…å±ä½†ä¸å¤ä½å…‰æ ‡ã€‚

#### å…‰æ ‡ç§»åŠ¨

* `[mv <x> <y>]` : ç§»åŠ¨åˆ°ç»å¯¹åæ ‡ (è¡Œ, åˆ—)ã€‚
* `[mv +<x> -<y>]` : åŸºäºå½“å‰ä½ç½®ç›¸å¯¹ç§»åŠ¨ã€‚

#### è§†è§‰æ ·å¼

* `[color <RRGGBB>]` : è®¾ç½®å‰æ™¯è‰² (Hexæ ¼å¼ï¼Œå¦‚ `[color FF0000]`)ã€‚
* `[background <RRGGBBAA>]` : è®¾ç½®èƒŒæ™¯è‰² (æ”¯æŒAlphaé€šé“)ã€‚
* `[style <bold/italic/underline/strike>]` : å¯ç”¨æ ·å¼ï¼ˆå¯å¤šé€‰ï¼Œç©ºæ ¼åˆ†éš”ï¼‰ã€‚
* `[clearcolor]`, `[clearbackground]`, `[clearstyle]` : æ¸…é™¤å¯¹åº”è®¾ç½®ã€‚

### 4. é«˜çº§åŠŸèƒ½ï¼šå‡½æ•°ä¸åˆ«å

#### åˆ«å (Alias)

ä¸ºå¸¸ç”¨æŒ‡ä»¤ç»„åˆå®šä¹‰ç®€å†™ã€‚

```text
[@warn [color FF0000][style bold]]
[1b][warn]This is warning text!

```

#### å‡½æ•° (Function)

å®šä¹‰å¯å¤ç”¨çš„åŠ¨ç”»ç‰‡æ®µã€‚**å‡½æ•°ä½“å†…åªèƒ½ä½¿ç”¨ç›¸å¯¹æ—¶é—´**ã€‚

* **å®šä¹‰**ï¼š`[#å‡½æ•°å å‚æ•°1,å‚æ•°2]`
* **è°ƒç”¨**ï¼š`[å‡½æ•°å å€¼1,å€¼2]`

**ç¤ºä¾‹ï¼šé—ªçƒæ•ˆæœ**

```text
// å®šä¹‰
[#blink text]
[+0][color FF0000][text]
[+100][color FFFF00][text]
[+100][clearcolor][text]

// è°ƒç”¨
[4b][blink Hello!]

```

---

## ğŸ“‚ ç¤ºä¾‹è„šæœ¬ (Example)

```text
[bpm 120]
[00:00.000][clear]CLIPlayer Demo
[+1b][color 00FF00]Ready...
[+1b][color FFFF00]Set...
[+1b][color FF0000][style bold]GO!

// ä½¿ç”¨å‡½æ•°
[#move_text x,y,msg]
[+0][mv [x] [y]][msg]

[4b][move_text 10,5,Hello]
[+1b][move_text 15,6,World]

```

## ğŸ“„ è®¸å¯ (License)

Apache 2.0